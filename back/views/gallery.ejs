<!DOCTYPE html>
<html>
<head>
  <title>Image Gallery</title>
  <style>
		body, html {
			display: flex;
			flex-direction: column;
			margin: 0;
			padding: 0;
			height: 100%;
			justify-content: center;
			align-items: center;
			background-size: cover;

			/* background-image: url('https://coolbackgrounds.io/images/backgrounds/index/sea-edge-79ab30e2.png'); */
		}
		.app-display-wrapper {
			width: 100%;
			height: 100%;
			display: flex;
			flex-direction: column;
			align-items: center;
			justify-content: flex-start;
		}
		.app-header {
			width: 100%;
			height: 15%;
			display: flex;
			margin-bottom: 3vh;
			flex-direction: column;
			align-items: center;
			justify-content: center;
			min-height: 100px;
			background-color: white;
		}
		.app-header h1 {
			margin-top: 3vh;
			text-align: center;
		}
		.searchbar-container {
			width: 100%;
			height: 100%;
			display: flex;
			flex-direction: row;
			align-items: center;
			justify-content: center;
		}
		.input-searchbar {
			width: 80%;
			height: 20%;
			padding: 1vh 2vh;
			border: none;
			border-radius: 1vh;
			background-color: #f1f1f1;
			font-size: 16px;
			margin-bottom: 2vh;
		}
		.input-searchbar:focus {
			outline: none;
			background-color: #e8e8e8;
		}
		.make-search-button {
			width: 10%;
			height: 100%;
			display: flex;
			justify-content: center;
			align-items: center; 
		}
		.make-search-button img {
			width: 50px;
			height: 50px;
			margin-bottom: 2vh;
		}
		.image-container {
      		display: flex;
			flex-wrap: wrap;
			justify-content: center;
			gap: 4vh;
      		width: 80%;
			height: 80%;
      		overflow-y: auto;
    	}
		.image-container img {
			border: 2.2px solid black;
			background-color: white;
			padding: 5vh;
			height: auto;	
			width: calc(25% - 10px);
			max-width: 200px;
			max-height: 200px;
			min-width: 100px;
			min-height: 100px;
			margin-top: 1vh;
			margin-bottom: 2vh;
		}
		.image-container::-webkit-scrollbar {
			width: 1vh;
		}
		.image-container::-webkit-scrollbar-thumb {
			background-color: rgba(0, 0, 0, 0.3);
			border-radius: 10px;
		}
		.image-container {
			scrollbar-width: thin;
		}
		.image-container::-webkit-scrollbar-thumb {
			background-color: rgba(0, 0, 0, 0.3);
			border-radius: 10px;
		}
		.image-container::-webkit-scrollbar-track {
			background-color: transparent;
		}
		.image-container::-webkit-scrollbar-track-piece {
			background-color: transparent;
		}
  </style>
</head>
<body>
	<div class="app-display-wrapper">
			<div class="app-header">
				<h1>Image Gallery</h1>
				<div class="searchbar-container">
					<input class="input-searchbar" type="text" >
					<div class="make-search-button">
						<img onclick="searchImages()" src="https://icon-library.com/images/search-icon-image/search-icon-image-1.jpg" alt="png" />
					</div>
				</div>
			</div>
		<div class="image-container">
				<% images.forEach(image => { %>
					<img src="/uploads/<%= image %>" alt="<%= image %>">
				<% }); %>
			</div>
		</div>
		<script>
			function searchImages() {
				const input = document.querySelector(".input-searchbar")
				const query = input.value.trim()
				fetch(`/api/search?query=${query}`)
				.then((res) => res.json())
				.then((data) => {
					const newImages = data.images
					const imageContainer = document.querySelector(".image-container")
					imageContainer.innerHTML = ""
					newImages.forEach((imageName) => {
						const imgElement = document.createElement("img")
						imgElement.src = `/uploads/${imageName}`
						imgElement.alt = imageName
						imgElement.dataset.image = imageName
						imageContainer.appendChild(imgElement)
						})
				})
				.catch((err) => console.error("Error fetching images:", err))
				input.value = ''
			}
		</script>
</body>
</html>
